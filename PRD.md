# PRD: where-was-i

## 개요

ADHD 환자 혹은 꾸준한 집중과 과업 추적이 필요한 사용자를 위한 비서 앱.
사용자가 하루 계획을 수립하고 일과 중 과업 수행을 추적하여 성공적인 하루를 보낼 수 있도록 돕는다.

## 목표

- 사용자가 하루에 대한 계획을 수립하고 이를 성공적으로 수행하는 것을 돕는다
- 계획의 실행을 꾸준히 추적하고 기록할 수 있도록 돕는다
- 빠르고 간편한 기록을 통해 사용자의 인지 부담을 최소화한다

## 플랫폼 및 기술

| 항목 | 결정 |
|------|------|
| 플랫폼 | PWA (Progressive Web App) |
| 데이터 저장 | 브라우저 로컬 저장소 (IndexedDB) |
| 디바이스 동기화 | 없음 (단일 디바이스) |
| 사용자 인증 | 없음 |
| AI/LLM 연동 | 사용자 API 키 직접 입력 (OpenAI 또는 Anthropic) |

### AI/LLM 연동 상세

- 사용자가 설정 화면에서 OpenAI 또는 Anthropic API 키를 직접 입력
- API 키는 IndexedDB에 로컬 저장 (서버 전송 없음)
- API 키가 없으면 AI 기능 비활성화, 수동 과업 입력으로 동작
- 로컬 퍼스트 철학과 일관성 유지, 서버 운영 부담 없음

## 디자인 원칙

### 모바일 퍼스트 PWA

- 모바일 환경에서 PWA 앱을 사용한다고 가정
- 최대한 사용자가 포커스를 옮길 필요 없도록 구현
- 터치 인터랙션 최적화

### 접근성

- 접근성 최대한 고려
- 명확한 포커스 표시
- 적절한 ARIA 레이블

### 채팅형 Progressive Form

- 계획 페이지는 채팅형 UI로 구현
- 스텝별 화면 전환이 아닌, 한 화면에서 스텝이 아래로 누적되는 형태
- 각 단계가 완료되면 다음 단계 요소가 아래쪽에 추가됨
- 대화하듯 자연스러운 흐름으로 계획 수립

### Floating Input

- 앱 하단에 항상 Floating 채팅 Input 표시
- 가급적이면 모든 입력은 그곳을 통해서 진행
- 한글 IME 조합 처리 지원

## 데이터 모델

### Task (일일 과업)

오늘 또는 특정 날짜에 수행할 구체적인 과업.

| 속성 | 타입 | 설명 |
|------|------|------|
| id | string | 고유 식별자 |
| title | string | 과업 제목 |
| status | enum | 대기(pending), 진행중(in_progress), 완료(completed), 취소(cancelled) |
| date | date | 수행 예정 날짜 |
| events | TaskEvent[] | 상태 변화 이벤트 로그 |
| createdAt | datetime | 생성 시각 |
| updatedAt | datetime | 수정 시각 |

### TaskEvent (과업 이벤트)

Task 내부에 배열로 저장되는 상태 변화 기록. 로그 페이지에서 타임라인 뷰로 하루 흐름을 시각화한다.

| 속성 | 타입 | 설명 |
|------|------|------|
| eventType | enum | started(시작), paused(일시정지), completed(완료), cancelled(취소) |
| timestamp | datetime | 이벤트 발생 시각 |

**이벤트 기록 규칙:**
- 과업 시작 시 `started` 이벤트 기록
- 다른 과업으로 전환 시 기존 진행중 과업에 `paused` 이벤트 기록
- 과업 완료 시 `completed` 이벤트 기록
- 과업 취소 시 `cancelled` 이벤트 기록

### 설계 결정

- **Task 상태**: 4종 (대기, 진행중, 완료, 취소)
- **하루의 정의**: 날짜(date) 필드 기준. 타임라인 뷰와 미완료 과업 판별에 사용
- **우선순위**: 없음
- **예상 소요 시간**: 없음
- **주기적 과업**: MVP에서 제외

## 주요 기능

### 1. 계획 페이지 (MVP 포함)

오늘 Task가 없으면 계획 페이지로 자동 이동. 채팅형 UI로 구현.

#### UI 방식

- 한 화면에서 모든 스텝이 진행됨 (화면 전환 없음)
- 각 스텝 완료 시 다음 스텝이 아래쪽에 추가되는 형태
- 채팅처럼 대화가 누적되는 느낌

#### 흐름

**엔트리 단계**
- 해당 날짜에 만든 계획이 없다면 인사와 함께 계획을 시작하시겠습니까 + 시작하기 버튼 출력
- 오늘 Task가 있으면 바로 과업 페이지로 이동

**Step 1: 미완료 과업 선택** (시작하기 클릭 후 아래에 추가됨)
- 전날 완료하지 못한 과업 리스트 표시
- 모든 과업을 비활성화(선택되지 않은 상태)로 표시
- 각 과업을 클릭하면 오늘 과업에 포함/미포함 여부가 토글
- "진행하기" 버튼으로 다음 단계로 진행

**Step 2: 오늘 과업 추가** (진행하기 클릭 후 아래에 추가됨)
- 오늘 과업 리스트를 표시
- Floating Input을 통해서 과업 내용 추가
- 리스트에서 인라인 수정/삭제 가능
- "완료" 버튼으로 과업 페이지로 이동

### 2. 과업 페이지 (MVP 포함)

일과 중에 과업 수행을 기록하고 추적한다.

#### 메인 화면 구성

- **통합 과업 목록**: 섹션 구분 없이 모든 과업을 하나의 리스트로 표시
- **진행중 과업 강조**: 스타일로 명확히 구분 (시작 시간 또는 실시간 소요시간 표시)
- **하단**: Floating Input으로 새 과업 추가

#### 진행중 과업 표시

- 섹션 분리 대신 스타일로 진행중 상태를 명확히 표현
- 시작 시간 표시 (예: "10:30부터") 또는 실시간 소요시간 표시 (예: "23분 경과")
- 현재 진행 중임을 직관적으로 인지할 수 있도록 시각적 강조

#### 인터랙션

| 액션 | 결과 |
|------|------|
| 진행중 과업 체크박스 클릭 | 과업 완료 처리 |
| 대기중 과업 클릭 | 해당 과업이 진행중으로 변경, 기존 진행중 과업은 대기로 |
| Floating Input에 입력 | 새 과업 생성 (계획에 없던 과업) |

### 3. 로그 페이지 (MVP 포함)

#### 타임라인 뷰

- TaskEvent 기반으로 하루 동안 어떤 과업을 언제 시작/중지/완료했는지 시각화
- 시간순 정렬

### 4. 설정 페이지 (MVP 포함)

#### API 키 관리

- Provider 선택 (OpenAI / Anthropic)
- API 키 입력/저장/삭제
- 연결 상태 표시

## MVP 범위

### 포함

1. **계획 페이지**
   - Task 생성/수정/삭제
   - 미완료 Task 리마인드 (토글 기반)
   - Progressive Form 플로우

2. **과업 페이지**
   - 현재 Task 기록
   - Task 상태 변경
   - Floating Input으로 빠른 과업 추가

3. **로그 페이지**
   - 타임라인 뷰

4. **설정 페이지**
   - API 키 설정

### 제외

- AI 검토 기능 (과업 분리/구체화 제안)
- 주기적 과업
- 알림 기능
- 통계/분석
- 멀티 디바이스 동기화

## 비기능 요구사항

- **빠른 접근**: 홈 화면 아이콘 탭 한 번으로 앱 진입
- **최소 입력**: 과업 기록 시 불필요한 입력 최소화
- **오프라인 지원**: 네트워크 없이도 기본 기능 동작 (AI 기능 제외)
- **데이터 보존**: 브라우저 데이터 삭제 전까지 로컬에 안전하게 저장
